-- ⚡ ULTIMATE ANTI-LAG V2 ⚡

local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")

-- Fast lookup table for destruction types
local destroyTypes = {
    ParticleEmitter = true,
    Trail = true,
    Beam = true,
    Fire = true,
    Smoke = true,
    Sparkles = true,
    Explosion = true,
    ForceField = true,
    Highlight = true,
    ShirtGraphic = true,
    Decal = true,
    Texture = true,
    SurfaceAppearance = true,
    Shirt = true,
    Pants = true,
}

local cleaned = {}

local function cleanObject(obj)
    if cleaned[obj] then return end

    local class = obj.ClassName

    -- Instantly delete unwanted junk
    if destroyTypes[class] then
        obj:Destroy()
        return
    end

    -- Optimize physical parts
    if obj:IsA("BasePart") then
        obj.Material = Enum.Material.SmoothPlastic
        obj.Reflectance = 0
        obj.CastShadow = false
        if obj.CanCollide == false then
            obj.CanQuery = false
            obj.CanTouch = false
        end
    end

    -- Silence ALL new sounds
    if obj:IsA("Sound") then
        obj.Volume = 0
        obj:Stop()
    end

    cleaned[obj] = true
end

-- Clean current objects
for _, descendant in ipairs(workspace:GetDescendants()) do
    cleanObject(descendant)
end

for _, descendant in ipairs(Lighting:GetDescendants()) do
    cleanObject(descendant)
end

-- EVENT-BASED CLEANING FOR MAX PERFORMANCE
workspace.DescendantAdded:Connect(cleanObject)
Lighting.DescendantAdded:Connect(cleanObject)

-- LIGHTING OPTIMIZATION
Lighting.GlobalShadows = false
Lighting.FogEnd = 1e9
pcall(function()
    Lighting.Technology = Enum.Technology.Compatibility
end)

-- TERRAIN OPTIMIZATION
pcall(function()
    local t = workspace.Terrain
    t.WaterReflectance = 0
    t.WaterTransparency = 1
    t.WaterWaveSize = 0
    t.WaterWaveSpeed = 0
    t.Decoration = false
end)

print("⚡ ULTIMATE ANTI-LAG V2 ENABLED ⚡")
