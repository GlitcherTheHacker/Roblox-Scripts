_G.HeadSize = 10
_G.HitboxSize = Vector3.new(10, 10, 10)
_G.Disabled = false
_G.ToggleKey = Enum.KeyCode.H

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local hitboxes = {}

-- Toggle with key
game:GetService("UserInputService").InputBegan:Connect(function(input, isProcessed)
    if not isProcessed and input.KeyCode == _G.ToggleKey then
        _G.Disabled = not _G.Disabled
    end
end)

-- Update hitboxes each frame without freezing movement
RunService.RenderStepped:Connect(function()
    if _G.Disabled then return end
    local localPlayer = Players.LocalPlayer

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= localPlayer and player.Character and player.Character:FindFirstChild("Head") then
            pcall(function()
                local head = player.Character.Head

                -- Avoid constantly resizing the real head (fix freeze issue)
                if not hitboxes[player] then
                    local hitbox = Instance.new("Part")
                    hitbox.Name = "Hitbox"
                    hitbox.Size = _G.HitboxSize
                    hitbox.Transparency = 1
                    hitbox.CanCollide = false
                    hitbox.Massless = true
                    hitbox.Anchored = false
                    hitbox.Parent = player.Character

                    local weld = Instance.new("WeldConstraint")
                    weld.Part0 = head
                    weld.Part1 = hitbox
                    weld.Parent = hitbox

                    hitboxes[player] = hitbox
                end

                local hitbox = hitboxes[player]
                hitbox.Size = _G.HitboxSize
                hitbox.CFrame = head.CFrame

                -- Optional: Health display
                local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    if not hitbox:FindFirstChild("HealthGui") then
                        local billboardGui = Instance.new("BillboardGui")
                        billboardGui.Name = "HealthGui"
                        billboardGui.Adornee = hitbox
                        billboardGui.Size = UDim2.new(0, 100, 0, 25)
                        billboardGui.StudsOffset = Vector3.new(0, 3, 0)
                        billboardGui.Parent = hitbox

                        local textLabel = Instance.new("TextLabel")
                        textLabel.Name = "HealthLabel"
                        textLabel.Size = UDim2.new(1, 0, 1, 0)
                        textLabel.BackgroundTransparency = 1
                        textLabel.TextColor3 = Color3.new(1, 1, 1)
                        textLabel.TextStrokeTransparency = 0.5
                        textLabel.TextScaled = true
                        textLabel.Font = Enum.Font.Gotham
                        textLabel.TextSize = 10
                        textLabel.Parent = billboardGui
                    end

                    local healthLabel = hitbox.HealthGui.HealthLabel
                    healthLabel.Text = string.format("Health: %.0f", humanoid.Health)
                end
            end)
        end
    end
end)
