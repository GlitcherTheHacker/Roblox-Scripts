--// ‚öîÔ∏è Dual Kill Aura System (Personal + Target Lock Aura)
--// Created by you, optimized and modular

--== CONFIG ==--
local auraRange = 30
local auraSize = Vector3.new(30, 30, 30)
local buttonSize = UDim2.new(0, 80, 0, 30) -- smaller button like screenshot

--== SERVICES ==--
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

--== STATE ==--
local SelectedPlayers = {}
local AuraParts = {}
local running = true
local screenGui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
screenGui.Name = "DualAuraGUI"

--== UI SETUP ==--
local auraButton = Instance.new("TextButton")
auraButton.Size = buttonSize
auraButton.Position = UDim2.new(0.45, 0, 0.05, 0)
auraButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
auraButton.TextColor3 = Color3.fromRGB(255, 255, 255)
auraButton.Text = "AURA"
auraButton.Parent = screenGui

local dropdown = Instance.new("ScrollingFrame")
dropdown.Size = UDim2.new(0, 160, 0, 220)
dropdown.Position = UDim2.new(0.45, 0, 0.05, 35)
dropdown.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
dropdown.Visible = false
dropdown.CanvasSize = UDim2.new(0, 0, 0, 0)
dropdown.ScrollBarThickness = 6
dropdown.Parent = screenGui

local uiList = Instance.new("UIListLayout", dropdown)
uiList.Padding = UDim.new(0, 3)
uiList.SortOrder = Enum.SortOrder.LayoutOrder

auraButton.MouseButton1Click:Connect(function()
    dropdown.Visible = not dropdown.Visible
end)

--== FUNCTIONS ==--
local function updatePlayerList()
    for _, btn in ipairs(dropdown:GetChildren()) do
        if btn:IsA("TextButton") then btn:Destroy() end
    end

    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer then
            local nameLength = #plr.Name
            local dynamicTextSize = math.clamp(20 - (nameLength / 2), 12, 20)

            local btn = Instance.new("TextButton")
            btn.Size = UDim2.new(1, -10, 0, 25)
            btn.Text = plr.Name
            btn.TextScaled = false
            btn.TextSize = dynamicTextSize
            btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            btn.TextColor3 = Color3.fromRGB(255, 255, 255)
            btn.Parent = dropdown

            btn.MouseButton1Click:Connect(function()
                if SelectedPlayers[plr] then
                    SelectedPlayers[plr] = nil
                    btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                    if AuraParts[plr] then
                        AuraParts[plr]:Destroy()
                        AuraParts[plr] = nil
                    end
                else
                    SelectedPlayers[plr] = true
                    btn.BackgroundColor3 = Color3.fromRGB(0, 180, 0)

                    local part = Instance.new("Part")
                    part.Anchored = true
                    part.CanCollide = false
                    part.Transparency = 1
                    part.Size = Vector3.new(12, 12, 12)
                    part.Name = "TargetAura_" .. plr.Name
                    part.Parent = workspace
                    AuraParts[plr] = part
                end
            end)
        end
    end
end

Players.PlayerAdded:Connect(updatePlayerList)
Players.PlayerRemoving:Connect(updatePlayerList)
updatePlayerList()

--== AURA CORE ==--
local function getChar(plr)
    return plr and plr.Character
end

local function getHRP(plr)
    local char = getChar(plr)
    return char and char:FindFirstChild("HumanoidRootPart")
end

local function getTouchPart(tool)
    local tx = tool and tool:FindFirstChildWhichIsA("TouchTransmitter", true)
    return tx and tx.Parent
end

local function getEnemies()
    local chars = {}
    for _, p in ipairs(Players:GetPlayers()) do
        if p ~= LocalPlayer then
            local c = getChar(p)
            if c and c:FindFirstChildOfClass("Humanoid") then
                table.insert(chars, c)
            end
        end
    end
    return chars
end

local function attack(tool, touchPart, target)
    if tool and touchPart and target then
        firetouchinterest(touchPart, target, 1)
        firetouchinterest(touchPart, target, 0)
    end
end

--== MAIN LOOP ==--
RunService.Heartbeat:Connect(function()
    local myChar = getChar(LocalPlayer)
    local myHRP = getHRP(LocalPlayer)
    if not myChar or not myHRP then return end

    local tools = {}
    for _, t in ipairs(myChar:GetChildren()) do
        if t:IsA("Tool") then table.insert(tools, t) end
    end

    -- üåÄ Update Target Aura positions
    for plr, aura in pairs(AuraParts) do
        local hrp = getHRP(plr)
        if hrp then
            aura.CFrame = hrp.CFrame
        end
    end

    -- ‚öîÔ∏è Attack selected targets
    for _, tool in ipairs(tools) do
        local touch = getTouchPart(tool)
        if touch then
            tool:Activate()
            for _, aura in pairs(AuraParts) do
                attack(tool, touch, aura)
            end
        end
    end

    -- üå™Ô∏è Personal aura around you
    local enemies = getEnemies()
    local params = OverlapParams.new()
    params.FilterDescendantsInstances = enemies
    params.FilterType = Enum.RaycastFilterType.Include

    for _, tool in ipairs(tools) do
        local touch = getTouchPart(tool)
        if touch then
            tool:Activate()
            local partsInBox = workspace:GetPartBoundsInBox(myHRP.CFrame, auraSize, params)
            for _, part in ipairs(partsInBox) do
                local model = part:FindFirstAncestorWhichIsA("Model")
                if model and table.find(enemies, model) then
                    attack(tool, touch, part)
                end
            end
        end
    end
end)

print("‚úÖ Dual Kill Aura System Loaded: Personal + Target Lock Active")
